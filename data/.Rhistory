library("diffexpR")
x <- rnorm(100,20,2)
y <- c(rnorm(40, 18,2), rnorm(60, 23,2))
wasserstein_metric(x,y)
library("transport")
wasserstein1d(x,y)
wasserstein_metric(x,y,2)
wasserstein1d(x,y,2)
x <- rnorm(105,20,2)
wasserstein_metric(x,y,2)
wasserstein1d(x,y,2)
1 - (wasserstein1d(x,y,2) / wasserstein_metric(x,y,2))
x
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
r1 <- wasserstein_metric(x,y,2)
r2 <- wasserstein1d(x,y,2)
wasserstein_metric(x,y,2)
detach("package:diffexpR", unload = TRUE)
r1 <- wasserstein_metric(x,y,2)
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
eval(wasserstein_metric(x,y,2))
(wasserstein_metric(x,y,2)
wasserstein_metric(x,y,2)
wasserstein_metric(x,y,2)
x <- rnorm(100,20,2)
wasserstein_metric(x,y,2)
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
Rcua <- c( 0.0099009900990099, 0.0198019801980198, 0.0297029702970297, 0.0396039603960396, 0.0495049504950495, 0.0594059405940594, 0.0693069306930693, 0.0792079207920792, 0.0891089108910891, 0.099009900990099, 0.108910891089109, 0.118811881188119, 0.128712871287129, 0.138613861386139, 0.148514851485149, 0.158415841584158, 0.168316831683168, 0.178217821782178, 0.188118811881188, 0.198019801980198, 0.207920792079208, 0.217821782178218, 0.227722772277228, 0.237623762376238, 0.247524752475248, 0.257425742574257, 0.267326732673267, 0.277227722772277, 0.287128712871287, 0.297029702970297, 0.306930693069307, 0.316831683168317, 0.326732673267327, 0.336633663366337, 0.346534653465347, 0.356435643564356, 0.366336633663366, 0.376237623762376, 0.386138613861386, 0.396039603960396, 0.405940594059406, 0.415841584158416, 0.425742574257426, 0.435643564356436, 0.445544554455446, 0.455445544554455, 0.465346534653465, 0.475247524752475, 0.485148514851485, 0.495049504950495, 0.504950495049505, 0.514851485148515, 0.524752475247525, 0.534653465346535, 0.544554455445545, 0.554455445544555, 0.564356435643564, 0.574257425742574, 0.584158415841584, 0.594059405940594, 0.603960396039604, 0.613861386138614, 0.623762376237624, 0.633663366336634, 0.643564356435644, 0.653465346534653, 0.663366336633663, 0.673267326732673, 0.683168316831683, 0.693069306930693, 0.702970297029703, 0.712871287128713, 0.722772277227723, 0.732673267326733, 0.742574257425743, 0.752475247524752, 0.762376237623762, 0.772277227722772, 0.782178217821782, 0.792079207920792, 0.801980198019802, 0.811881188118812, 0.821782178217822, 0.831683168316832, 0.841584158415842, 0.851485148514851, 0.861386138613861, 0.871287128712871, 0.881188118811881, 0.891089108910891, 0.900990099009901, 0.910891089108911, 0.920792079207921, 0.930693069306931, 0.940594059405941, 0.95049504950495, 0.96039603960396, 0.97029702970297, 0.98019801980198, 0.99009900990099)
cub <- c(cub  =  0.0099009900990099, 0.0198019801980198, 0.0297029702970297, 0.0396039603960396, 0.0495049504950495, 0.0594059405940594, 0.0693069306930693, 0.0792079207920792, 0.0891089108910891, 0.099009900990099, 0.108910891089109, 0.118811881188119, 0.128712871287129, 0.138613861386139, 0.148514851485149, 0.158415841584158, 0.168316831683168, 0.178217821782178, 0.188118811881188, 0.198019801980198, 0.207920792079208, 0.217821782178218, 0.227722772277228, 0.237623762376238, 0.247524752475248, 0.257425742574257, 0.267326732673267, 0.277227722772277, 0.287128712871287, 0.297029702970297, 0.306930693069307, 0.316831683168317, 0.326732673267327, 0.336633663366337, 0.346534653465347, 0.356435643564356, 0.366336633663366, 0.376237623762376, 0.386138613861386, 0.396039603960396, 0.405940594059406, 0.415841584158416, 0.425742574257426, 0.435643564356436, 0.445544554455446, 0.455445544554455, 0.465346534653465, 0.475247524752475, 0.485148514851485, 0.495049504950495, 0.504950495049505, 0.514851485148515, 0.524752475247525, 0.534653465346535, 0.544554455445545, 0.554455445544555, 0.564356435643564, 0.574257425742574, 0.584158415841584, 0.594059405940594, 0.603960396039604, 0.613861386138614, 0.623762376237624, 0.633663366336634, 0.643564356435644, 0.653465346534653, 0.663366336633663, 0.673267326732673, 0.683168316831683, 0.693069306930693, 0.702970297029703, 0.712871287128713, 0.722772277227723, 0.732673267326733, 0.742574257425743, 0.752475247524752, 0.762376237623762, 0.772277227722772, 0.782178217821782, 0.792079207920792, 0.801980198019802, 0.811881188118812, 0.821782178217822, 0.831683168316832, 0.841584158415842, 0.851485148514851, 0.861386138613861, 0.871287128712871, 0.881188118811881, 0.891089108910891, 0.900990099009901, 0.910891089108911, 0.920792079207921, 0.930693069306931, 0.940594059405941, 0.95049504950495, 0.96039603960396, 0.97029702970297, 0.98019801980198, 0.99009900990099 )
CPPcua<- c( 0.00990099, 0.019802, 0.029703, 0.039604, 0.049505, 0.0594059, 0.0693069, 0.0792079, 0.0891089, 0.0990099, 0.108911, 0.118812, 0.128713, 0.138614, 0.148515, 0.158416, 0.168317, 0.178218, 0.188119, 0.19802, 0.207921, 0.217822, 0.227723, 0.237624, 0.247525, 0.257426, 0.267327, 0.277228, 0.287129, 0.29703, 0.306931, 0.316832, 0.326733, 0.336634, 0.346535, 0.356436, 0.366337, 0.376238, 0.386139, 0.39604, 0.405941, 0.415842, 0.425743, 0.435644, 0.445545, 0.455446, 0.465347, 0.475248, 0.485149, 0.49505, 0.50495, 0.514851, 0.524752, 0.534653, 0.544554, 0.554455, 0.564356, 0.574257, 0.584158, 0.594059, 0.60396, 0.613861, 0.623762, 0.633663, 0.643564, 0.653465, 0.663366, 0.673267, 0.683168, 0.693069, 0.70297, 0.712871, 0.722772, 0.732673, 0.742574, 0.752475, 0.762376, 0.772277, 0.782178, 0.792079, 0.80198, 0.811881, 0.821782, 0.831683, 0.841584, 0.851485, 0.861386, 0.871287, 0.881188, 0.891089, 0.90099, 0.910891, 0.920792, 0.930693, 0.940594, 0.950495, 0.960396, 0.970297, 0.980198, 0.990099, )
CPPcua<- c( 0.00990099, 0.019802, 0.029703, 0.039604, 0.049505, 0.0594059, 0.0693069, 0.0792079, 0.0891089, 0.0990099, 0.108911, 0.118812, 0.128713, 0.138614, 0.148515, 0.158416, 0.168317, 0.178218, 0.188119, 0.19802, 0.207921, 0.217822, 0.227723, 0.237624, 0.247525, 0.257426, 0.267327, 0.277228, 0.287129, 0.29703, 0.306931, 0.316832, 0.326733, 0.336634, 0.346535, 0.356436, 0.366337, 0.376238, 0.386139, 0.39604, 0.405941, 0.415842, 0.425743, 0.435644, 0.445545, 0.455446, 0.465347, 0.475248, 0.485149, 0.49505, 0.50495, 0.514851, 0.524752, 0.534653, 0.544554, 0.554455, 0.564356, 0.574257, 0.584158, 0.594059, 0.60396, 0.613861, 0.623762, 0.633663, 0.643564, 0.653465, 0.663366, 0.673267, 0.683168, 0.693069, 0.70297, 0.712871, 0.722772, 0.732673, 0.742574, 0.752475, 0.762376, 0.772277, 0.782178, 0.792079, 0.80198, 0.811881, 0.821782, 0.831683, 0.841584, 0.851485, 0.861386, 0.871287, 0.881188, 0.891089, 0.90099, 0.910891, 0.920792, 0.930693, 0.940594, 0.950495, 0.960396, 0.970297, 0.980198, 0.990099 )
CPPcub <- c( 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99)
abs CPPcua - Rcua
abs() CPPcua - Rcua)
abs( CPPcua - Rcua)
CPParep = c(1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1)
CPPbrep = c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)
Rarep = c(a_rep  =  1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1
)
Rbrep = c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 )
Rarep = c1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1)
Rarep = c(1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1)
Rarep == CPParep
Rbrep == CPPbrep
Rcua == CPPcua
round(Rcua,4) == round(CPPcua,4)
Raa <- c(14.2410543215104, 14.846317838454, 14.846317838454, 15.7401117954929, 15.7401117954929, 15.8618035139457, 15.8618035139457, 16.3060131871663, 16.3060131871663, 16.391866910132, 16.391866910132, 16.560453022474, 16.560453022474, 16.6567502236689, 16.6567502236689, 16.6642629763937, 16.6642629763937, 16.7571333765296, 16.7571333765296, 16.8650946543915, 16.8650946543915, 16.8716606331973, 16.8716606331973, 17.6260813949382, 17.6260813949382, 17.6706566796932, 17.6706566796932, 17.8057620616283, 17.8057620616283, 17.9267054398297, 17.9267054398297, 18.0027759708895, 18.0027759708895, 18.0813290229391, 18.0813290229391, 18.1101694264176, 18.1101694264176, 18.2150669741582, 18.2150669741582, 18.3975037409391, 18.3975037409391, 18.4684040228784, 18.4684040228784, 18.5018197521635, 18.5018197521635, 18.6800740353261, 18.6800740353261, 18.74033584262, 18.74033584262, 18.9300933999251, 18.9300933999251, 19.0188853112595, 19.0188853112595, 19.0580969236868, 19.0580969236868, 19.0745220411481, 19.0745220411481, 19.0793083365712, 19.0793083365712, 19.115208074991, 19.115208074991, 19.1337505639032, 19.1337505639032, 19.2964836266984, 19.2964836266984, 19.3839570248775, 19.3839570248775, 19.4086333387633, 19.4086333387633, 19.4438334676605, 19.4438334676605, 19.5281292728353, 19.5281292728353, 19.5623408244, 19.5623408244, 19.6177636346404, 19.6177636346404, 19.7676145643428, 19.7676145643428, 19.815113140753, 19.815113140753, 19.8863857565444, 19.8863857565444, 20.0057156027117, 20.0057156027117, 20.1004202707484, 20.1004202707484, 20.1070325799634, 20.1070325799634, 20.1495566451074, 20.1495566451074, 20.1733055117087, 20.1733055117087, 20.2688288111056, 20.2688288111056, 20.3254516894945, 20.3254516894945, 20.3636156109554, 20.3636156109554, 20.4495481017521, 20.4495481017521, 20.4553009238177, 20.4553009238177, 20.4798385991039, 20.4798385991039, 20.5131851551263, 20.5131851551263, 20.6738955455007, 20.6738955455007, 20.6928946822237, 20.6928946822237, 20.7306504831539, 20.7306504831539, 20.7722953351104, 20.7722953351104, 20.7997388045066, 20.7997388045066, 20.8961017674264, 20.8961017674264, 20.9111260316976, 20.9111260316976, 20.9211613803248, 20.9211613803248, 20.9453559437352, 20.9453559437352, 20.9815587569817, 20.9815587569817, 21.0324195923479, 21.0324195923479, 21.0451058548543, 21.0451058548543, 21.0562628747556, 21.0562628747556, 21.0654498746713, 21.0654498746713, 21.1053404300043, 21.1053404300043, 21.1569490308353, 21.1569490308353, 21.1671834244541, 21.1671834244541, 21.1763513514449, 21.1763513514449, 21.2033377758944, 21.2033377758944, 21.2221825107979, 21.2221825107979, 21.302655186968, 21.302655186968, 21.5213250251691, 21.5213250251691, 21.6057626578766, 21.6057626578766, 21.6526443079026, 21.6526443079026, 21.72229739825, 21.72229739825, 21.8197255918818, 21.8197255918818, 21.8992019286583, 21.8992019286583, 21.9348695922427, 21.9348695922427, 21.9388116211537, 21.9388116211537, 21.9485229652231, 21.9485229652231, 22.0510487671729, 22.0510487671729, 22.0658047171634, 22.0658047171634, 22.0927469710922, 22.0927469710922, 22.1489227453001, 22.1489227453001, 22.1752259134324, 22.1752259134324, 22.3553625944325, 22.3553625944325, 22.5004361100661, 22.5004361100661, 22.6871437603267, 22.6871437603267, 22.8092525298437, 22.8092525298437, 22.9063063062892, 22.9063063062892, 22.907879823602, 22.907879823602, 23.2008333211141, 23.2008333211141, 23.6523196432635, 23.6523196432635, 23.8011924064885, 23.8011924064885, 24.0572138661479, 24.0572138661479, 24.7724968522092, 24.7724968522092, 25.6148990905184)
Rbb <- c( 12.376141101926, 12.376141101926, 14.5014830342334, 14.5014830342334, 15.4138514959367, 15.4138514959367, 15.4364166464365, 15.4364166464365, 15.8303306890592, 15.8303306890592, 15.8356258310055, 15.8356258310055, 16.047529784711, 16.047529784711, 16.3771611586041, 16.3771611586041, 16.4654147319825, 16.4654147319825, 16.5889970856801, 16.5889970856801, 16.6252846318948, 16.6252846318948, 16.7348367269952, 16.7348367269952, 16.802498447828, 16.802498447828, 16.8654477571701, 16.8654477571701, 16.8856833015697, 16.8856833015697, 16.967054142568, 16.967054142568, 17.1533899844087, 17.1533899844087, 17.1655000486845, 17.1655000486845, 17.2117910210821, 17.2117910210821, 17.3159732337979, 17.3159732337979, 17.4308455983366, 17.4308455983366, 17.5594183098903, 17.5594183098903, 17.7240863546562, 17.7240863546562, 17.7381407782908, 17.7381407782908, 17.81016884548, 17.81016884548, 17.8176941577179, 17.8176941577179, 17.9019738446851, 17.9019738446851, 17.9487042007524, 17.9487042007524, 18.2720806143374, 18.2720806143374, 18.5700529359009, 18.5700529359009, 18.7679025853818, 18.7679025853818, 19.0749015093616, 19.0749015093616, 19.0795370873859, 19.0795370873859, 19.0947373069595, 19.0947373069595, 19.1414542488283, 19.1414542488283, 19.1496503024881, 19.1496503024881, 19.1894934773157, 19.1894934773157, 19.5212459047802, 19.5212459047802, 20.0006496660891, 20.0006496660891, 20.1083945099579, 20.1083945099579, 20.28449290894, 20.28449290894, 20.7046639223127, 20.7046639223127, 20.7766404502312, 20.7766404502312, 20.814647502679, 20.814647502679, 20.8447212276957, 20.8447212276957, 21.1233511392925, 21.1233511392925, 21.1690167964967, 21.1690167964967, 21.2127336920173, 21.2127336920173, 21.2369686186945, 21.2369686186945, 21.4060709755851, 21.4060709755851, 21.4255202781917, 21.4255202781917, 21.50477334805, 21.50477334805, 21.6014654460828, 21.6014654460828, 21.6305190813666, 21.6305190813666, 21.7480924007449, 21.7480924007449, 21.7777458308869, 21.7777458308869, 21.8210464179176, 21.8210464179176, 21.9874828297776, 21.9874828297776, 22.1444465036459, 22.1444465036459, 22.3102570773264, 22.3102570773264, 22.3201437620332, 22.3201437620332, 22.3449338283417, 22.3449338283417, 22.351758450209, 22.351758450209, 22.3663428538593, 22.3663428538593, 22.3873684499023, 22.3873684499023, 22.4219581856788, 22.4219581856788, 22.4850540187833, 22.4850540187833, 22.4894557834834, 22.4894557834834, 22.5069797574498, 22.5069797574498, 22.5387444538829, 22.5387444538829, 22.6576141141398, 22.6576141141398, 22.8867691679578, 22.8867691679578, 23.1889116318395, 23.1889116318395, 23.1941242095764, 23.1941242095764, 23.2380504336151, 23.2380504336151, 23.242189988141, 23.242189988141, 23.2556810358095, 23.2556810358095, 23.3217024942141, 23.3217024942141, 23.3907137464093, 23.3907137464093, 23.4444318990619, 23.4444318990619, 23.5770413261814, 23.5770413261814, 23.7513255110108, 23.7513255110108, 23.8289161145904, 23.8289161145904, 23.8561612000204, 23.8561612000204, 23.8716175254108, 23.8716175254108, 23.8763555276771, 23.8763555276771, 23.9965438496212, 23.9965438496212, 24.0633693174211, 24.0633693174211, 24.1097655133677, 24.1097655133677, 24.1989040506893, 24.1989040506893, 24.209616537555, 24.209616537555, 24.5930007487006, 24.5930007487006, 24.7794996939041, 24.7794996939041, 24.8045978390335, 24.8045978390335, 24.8948198898544, 24.8948198898544, 25.2128942370914, 25.2128942370914, 25.6819246779338, 25.6819246779338, 25.9221253712952, 25.9221253712952, 26.2539719628096, 26.2539719628096, 26.524756953804, 26.524756953804 )
CPPaa = c( 14.2411, 14.8463, 14.8463, 15.7401, 15.7401, 15.8618, 15.8618, 16.306, 16.306, 16.3919, 16.3919, 16.5605, 16.5605, 16.6568, 16.6568, 16.6643, 16.6643, 16.7571, 16.7571, 16.8651, 16.8651, 16.8717, 16.8717, 17.6261, 17.6261, 17.6707, 17.6707, 17.8058, 17.8058, 17.9267, 17.9267, 18.0028, 18.0028, 18.0813, 18.0813, 18.1102, 18.1102, 18.2151, 18.2151, 18.3975, 18.3975, 18.4684, 18.4684, 18.5018, 18.5018, 18.6801, 18.6801, 18.7403, 18.7403, 18.9301, 18.9301, 19.0189, 19.0189, 19.0581, 19.0581, 19.0745, 19.0745, 19.0793, 19.0793, 19.1152, 19.1152, 19.1338, 19.1338, 19.2965, 19.2965, 19.384, 19.384, 19.4086, 19.4086, 19.4438, 19.4438, 19.5281, 19.5281, 19.5623, 19.5623, 19.6178, 19.6178, 19.7676, 19.7676, 19.8151, 19.8151, 19.8864, 19.8864, 20.0057, 20.0057, 20.1004, 20.1004, 20.107, 20.107, 20.1496, 20.1496, 20.1733, 20.1733, 20.2688, 20.2688, 20.3255, 20.3255, 20.3636, 20.3636, 20.4495, 20.4495, 20.4553, 20.4553, 20.4798, 20.4798, 20.5132, 20.5132, 20.6739, 20.6739, 20.6929, 20.6929, 20.7307, 20.7307, 20.7723, 20.7723, 20.7997, 20.7997, 20.8961, 20.8961, 20.9111, 20.9111, 20.9212, 20.9212, 20.9454, 20.9454, 20.9816, 20.9816, 21.0324, 21.0324, 21.0451, 21.0451, 21.0563, 21.0563, 21.0654, 21.0654, 21.1053, 21.1053, 21.1569, 21.1569, 21.1672, 21.1672, 21.1764, 21.1764, 21.2033, 21.2033, 21.2222, 21.2222, 21.3027, 21.3027, 21.5213, 21.5213, 21.6058, 21.6058, 21.6526, 21.6526, 21.7223, 21.7223, 21.8197, 21.8197, 21.8992, 21.8992, 21.9349, 21.9349, 21.9388, 21.9388, 21.9485, 21.9485, 22.051, 22.051, 22.0658, 22.0658, 22.0927, 22.0927, 22.1489, 22.1489, 22.1752, 22.1752, 22.3554, 22.3554, 22.5004, 22.5004, 22.6871, 22.6871, 22.8093, 22.8093, 22.9063, 22.9063, 22.9079, 22.9079, 23.2008, 23.2008, 23.6523, 23.6523, 23.8012, 23.8012, 24.0572, 24.0572, 24.7725, 24.7725, 25.6149)
CPPbb = c(12.3761, 12.3761, 14.5015, 14.5015, 15.4139, 15.4139, 15.4364, 15.4364, 15.8303, 15.8303, 15.8356, 15.8356, 16.0475, 16.0475, 16.3772, 16.3772, 16.4654, 16.4654, 16.589, 16.589, 16.6253, 16.6253, 16.7348, 16.7348, 16.8025, 16.8025, 16.8654, 16.8654, 16.8857, 16.8857, 16.9671, 16.9671, 17.1534, 17.1534, 17.1655, 17.1655, 17.2118, 17.2118, 17.316, 17.316, 17.4308, 17.4308, 17.5594, 17.5594, 17.7241, 17.7241, 17.7381, 17.7381, 17.8102, 17.8102, 17.8177, 17.8177, 17.902, 17.902, 17.9487, 17.9487, 18.2721, 18.2721, 18.5701, 18.5701, 18.7679, 18.7679, 19.0749, 19.0749, 19.0795, 19.0795, 19.0947, 19.0947, 19.1415, 19.1415, 19.1497, 19.1497, 19.1895, 19.1895, 19.5212, 19.5212, 20.0006, 20.0006, 20.1084, 20.1084, 20.2845, 20.2845, 20.7047, 20.7047, 20.7766, 20.7766, 20.8146, 20.8146, 20.8447, 20.8447, 21.1234, 21.1234, 21.169, 21.169, 21.2127, 21.2127, 21.237, 21.237, 21.4061, 21.4061, 21.4255, 21.4255, 21.5048, 21.5048, 21.6015, 21.6015, 21.6305, 21.6305, 21.7481, 21.7481, 21.7777, 21.7777, 21.821, 21.821, 21.9875, 21.9875, 22.1444, 22.1444, 22.3103, 22.3103, 22.3201, 22.3201, 22.3449, 22.3449, 22.3518, 22.3518, 22.3663, 22.3663, 22.3874, 22.3874, 22.422, 22.422, 22.4851, 22.4851, 22.4895, 22.4895, 22.507, 22.507, 22.5387, 22.5387, 22.6576, 22.6576, 22.8868, 22.8868, 23.1889, 23.1889, 23.1941, 23.1941, 23.2381, 23.2381, 23.2422, 23.2422, 23.2557, 23.2557, 23.3217, 23.3217, 23.3907, 23.3907, 23.4444, 23.4444, 23.577, 23.577, 23.7513, 23.7513, 23.8289, 23.8289, 23.8562, 23.8562, 23.8716, 23.8716, 23.8764, 23.8764, 23.9965, 23.9965, 24.0634, 24.0634, 24.1098, 24.1098, 24.1989, 24.1989, 24.2096, 24.2096, 24.593, 24.593, 24.7795, 24.7795, 24.8046, 24.8046, 24.8948, 24.8948, 25.2129, 25.2129, 25.6819, 25.6819, 25.9221, 25.9221, 26.254, 26.254, 26.5248, 26.5248)
round(CPPbb, 4) == round(Rbb, 4)
round(CPPaa, 4) == round(Raa, 4)
Ruu0 <- c(0, 0.0099009900990099, 0.01, 0.0198019801980198, 0.02, 0.0297029702970297, 0.03, 0.0396039603960396, 0.04, 0.0495049504950495, 0.05, 0.0594059405940594, 0.06, 0.0693069306930693, 0.07, 0.0792079207920792, 0.08, 0.0891089108910891, 0.09, 0.099009900990099, 0.1, 0.108910891089109, 0.11, 0.118811881188119, 0.12, 0.128712871287129, 0.13, 0.138613861386139, 0.14, 0.148514851485149, 0.15, 0.158415841584158, 0.16, 0.168316831683168, 0.17, 0.178217821782178, 0.18, 0.188118811881188, 0.19, 0.198019801980198, 0.2, 0.207920792079208, 0.21, 0.217821782178218, 0.22, 0.227722772277228, 0.23, 0.237623762376238, 0.24, 0.247524752475248, 0.25, 0.257425742574257, 0.26, 0.267326732673267, 0.27, 0.277227722772277, 0.28, 0.287128712871287, 0.29, 0.297029702970297, 0.3, 0.306930693069307, 0.31, 0.316831683168317, 0.32, 0.326732673267327, 0.33, 0.336633663366337, 0.34, 0.346534653465347, 0.35, 0.356435643564356, 0.36, 0.366336633663366, 0.37, 0.376237623762376, 0.38, 0.386138613861386, 0.39, 0.396039603960396, 0.4, 0.405940594059406, 0.41, 0.415841584158416, 0.42, 0.425742574257426, 0.43, 0.435643564356436, 0.44, 0.445544554455446, 0.45, 0.455445544554455, 0.46, 0.465346534653465, 0.47, 0.475247524752475, 0.48, 0.485148514851485, 0.49, 0.495049504950495, 0.5, 0.504950495049505, 0.51, 0.514851485148515, 0.52, 0.524752475247525, 0.53, 0.534653465346535, 0.54, 0.544554455445545, 0.55, 0.554455445544555, 0.56, 0.564356435643564, 0.57, 0.574257425742574, 0.58, 0.584158415841584, 0.59, 0.594059405940594, 0.6, 0.603960396039604, 0.61, 0.613861386138614, 0.62, 0.623762376237624, 0.63, 0.633663366336634, 0.64, 0.643564356435644, 0.65, 0.653465346534653, 0.66, 0.663366336633663, 0.67, 0.673267326732673, 0.68, 0.683168316831683, 0.69, 0.693069306930693, 0.7, 0.702970297029703, 0.71, 0.712871287128713, 0.72, 0.722772277227723, 0.73, 0.732673267326733, 0.74, 0.742574257425743, 0.75, 0.752475247524752, 0.76, 0.762376237623762, 0.77, 0.772277227722772, 0.78, 0.782178217821782, 0.79, 0.792079207920792, 0.8, 0.801980198019802, 0.81, 0.811881188118812, 0.82, 0.821782178217822, 0.83, 0.831683168316832, 0.84, 0.841584158415842, 0.85, 0.851485148514851, 0.86, 0.861386138613861, 0.87, 0.871287128712871, 0.88, 0.881188118811881, 0.89, 0.891089108910891, 0.9, 0.900990099009901, 0.91, 0.910891089108911, 0.92, 0.920792079207921, 0.93, 0.930693069306931, 0.94, 0.940594059405941, 0.95, 0.95049504950495, 0.96, 0.96039603960396, 0.97, 0.97029702970297, 0.98, 0.98019801980198, 0.99, 0.99009900990099 )
Ruu1 <- c( 0.0099009900990099, 0.01, 0.0198019801980198, 0.02, 0.0297029702970297, 0.03, 0.0396039603960396, 0.04, 0.0495049504950495, 0.05, 0.0594059405940594, 0.06, 0.0693069306930693, 0.07, 0.0792079207920792, 0.08, 0.0891089108910891, 0.09, 0.099009900990099, 0.1, 0.108910891089109, 0.11, 0.118811881188119, 0.12, 0.128712871287129, 0.13, 0.138613861386139, 0.14, 0.148514851485149, 0.15, 0.158415841584158, 0.16, 0.168316831683168, 0.17, 0.178217821782178, 0.18, 0.188118811881188, 0.19, 0.198019801980198, 0.2, 0.207920792079208, 0.21, 0.217821782178218, 0.22, 0.227722772277228, 0.23, 0.237623762376238, 0.24, 0.247524752475248, 0.25, 0.257425742574257, 0.26, 0.267326732673267, 0.27, 0.277227722772277, 0.28, 0.287128712871287, 0.29, 0.297029702970297, 0.3, 0.306930693069307, 0.31, 0.316831683168317, 0.32, 0.326732673267327, 0.33, 0.336633663366337, 0.34, 0.346534653465347, 0.35, 0.356435643564356, 0.36, 0.366336633663366, 0.37, 0.376237623762376, 0.38, 0.386138613861386, 0.39, 0.396039603960396, 0.4, 0.405940594059406, 0.41, 0.415841584158416, 0.42, 0.425742574257426, 0.43, 0.435643564356436, 0.44, 0.445544554455446, 0.45, 0.455445544554455, 0.46, 0.465346534653465, 0.47, 0.475247524752475, 0.48, 0.485148514851485, 0.49, 0.495049504950495, 0.5, 0.504950495049505, 0.51, 0.514851485148515, 0.52, 0.524752475247525, 0.53, 0.534653465346535, 0.54, 0.544554455445545, 0.55, 0.554455445544555, 0.56, 0.564356435643564, 0.57, 0.574257425742574, 0.58, 0.584158415841584, 0.59, 0.594059405940594, 0.6, 0.603960396039604, 0.61, 0.613861386138614, 0.62, 0.623762376237624, 0.63, 0.633663366336634, 0.64, 0.643564356435644, 0.65, 0.653465346534653, 0.66, 0.663366336633663, 0.67, 0.673267326732673, 0.68, 0.683168316831683, 0.69, 0.693069306930693, 0.7, 0.702970297029703, 0.71, 0.712871287128713, 0.72, 0.722772277227723, 0.73, 0.732673267326733, 0.74, 0.742574257425743, 0.75, 0.752475247524752, 0.76, 0.762376237623762, 0.77, 0.772277227722772, 0.78, 0.782178217821782, 0.79, 0.792079207920792, 0.8, 0.801980198019802, 0.81, 0.811881188118812, 0.82, 0.821782178217822, 0.83, 0.831683168316832, 0.84, 0.841584158415842, 0.85, 0.851485148514851, 0.86, 0.861386138613861, 0.87, 0.871287128712871, 0.88, 0.881188118811881, 0.89, 0.891089108910891, 0.9, 0.900990099009901, 0.91, 0.910891089108911, 0.92, 0.920792079207921, 0.93, 0.930693069306931, 0.94, 0.940594059405941, 0.95, 0.95049504950495, 0.96, 0.96039603960396, 0.97, 0.97029702970297, 0.98, 0.98019801980198, 0.99, 0.99009900990099, 1)
CPPuu0 <- c(0, 0.00990099, 0.019802, 0.029703, 0.039604, 0.049505, 0.0594059, 0.0693069, 0.0792079, 0.0891089, 0.0990099, 0.108911, 0.118812, 0.128713, 0.138614, 0.148515, 0.158416, 0.168317, 0.178218, 0.188119, 0.19802, 0.207921, 0.217822, 0.227723, 0.237624, 0.247525, 0.257426, 0.267327, 0.277228, 0.287129, 0.29703, 0.306931, 0.316832, 0.326733, 0.336634, 0.346535, 0.356436, 0.366337, 0.376238, 0.386139, 0.39604, 0.405941, 0.415842, 0.425743, 0.435644, 0.445545, 0.455446, 0.465347, 0.475248, 0.485149, 0.49505, 0.50495, 0.514851, 0.524752, 0.534653, 0.544554, 0.554455, 0.564356, 0.574257, 0.584158, 0.594059, 0.60396, 0.613861, 0.623762, 0.633663, 0.643564, 0.653465, 0.663366, 0.673267, 0.683168, 0.693069, 0.70297, 0.712871, 0.722772, 0.732673, 0.742574, 0.752475, 0.762376, 0.772277, 0.782178, 0.792079, 0.80198, 0.811881, 0.821782, 0.831683, 0.841584, 0.851485, 0.861386, 0.871287, 0.881188, 0.891089, 0.90099, 0.910891, 0.920792, 0.930693, 0.940594, 0.950495, 0.960396, 0.970297, 0.980198, 0.990099, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99)
CPPuu1 <- c(0.00990099, 0.019802, 0.029703, 0.039604, 0.049505, 0.0594059, 0.0693069, 0.0792079, 0.0891089, 0.0990099, 0.108911, 0.118812, 0.128713, 0.138614, 0.148515, 0.158416, 0.168317, 0.178218, 0.188119, 0.19802, 0.207921, 0.217822, 0.227723, 0.237624, 0.247525, 0.257426, 0.267327, 0.277228, 0.287129, 0.29703, 0.306931, 0.316832, 0.326733, 0.336634, 0.346535, 0.356436, 0.366337, 0.376238, 0.386139, 0.39604, 0.405941, 0.415842, 0.425743, 0.435644, 0.445545, 0.455446, 0.465347, 0.475248, 0.485149, 0.49505, 0.50495, 0.514851, 0.524752, 0.534653, 0.544554, 0.554455, 0.564356, 0.574257, 0.584158, 0.594059, 0.60396, 0.613861, 0.623762, 0.633663, 0.643564, 0.653465, 0.663366, 0.673267, 0.683168, 0.693069, 0.70297, 0.712871, 0.722772, 0.732673, 0.742574, 0.752475, 0.762376, 0.772277, 0.782178, 0.792079, 0.80198, 0.811881, 0.821782, 0.831683, 0.841584, 0.851485, 0.861386, 0.871287, 0.881188, 0.891089, 0.90099, 0.910891, 0.920792, 0.930693, 0.940594, 0.950495, 0.960396, 0.970297, 0.980198, 0.990099, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1)
CPPuu1 == Ruu1
round(CPPuu1,6) == round(Ruu1,6)
round(CPPuu1,5) == round(Ruu1,)
round(CPPuu1,5) == round(Ruu1,5)
length(CPPuu1) == length(Ruu1)
CPPuu1 - Ruu1
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
Ruu0 <- c(0, 0.0099009900990099, 0.01, 0.0198019801980198, 0.02, 0.0297029702970297, 0.03, 0.0396039603960396, 0.04, 0.0495049504950495, 0.05, 0.0594059405940594, 0.06, 0.0693069306930693, 0.07, 0.0792079207920792, 0.08, 0.0891089108910891, 0.09, 0.099009900990099, 0.1, 0.108910891089109, 0.11, 0.118811881188119, 0.12, 0.128712871287129, 0.13, 0.138613861386139, 0.14, 0.148514851485149, 0.15, 0.158415841584158, 0.16, 0.168316831683168, 0.17, 0.178217821782178, 0.18, 0.188118811881188, 0.19, 0.198019801980198, 0.2, 0.207920792079208, 0.21, 0.217821782178218, 0.22, 0.227722772277228, 0.23, 0.237623762376238, 0.24, 0.247524752475248, 0.25, 0.257425742574257, 0.26, 0.267326732673267, 0.27, 0.277227722772277, 0.28, 0.287128712871287, 0.29, 0.297029702970297, 0.3, 0.306930693069307, 0.31, 0.316831683168317, 0.32, 0.326732673267327, 0.33, 0.336633663366337, 0.34, 0.346534653465347, 0.35, 0.356435643564356, 0.36, 0.366336633663366, 0.37, 0.376237623762376, 0.38, 0.386138613861386, 0.39, 0.396039603960396, 0.4, 0.405940594059406, 0.41, 0.415841584158416, 0.42, 0.425742574257426, 0.43, 0.435643564356436, 0.44, 0.445544554455446, 0.45, 0.455445544554455, 0.46, 0.465346534653465, 0.47, 0.475247524752475, 0.48, 0.485148514851485, 0.49, 0.495049504950495, 0.5, 0.504950495049505, 0.51, 0.514851485148515, 0.52, 0.524752475247525, 0.53, 0.534653465346535, 0.54, 0.544554455445545, 0.55, 0.554455445544555, 0.56, 0.564356435643564, 0.57, 0.574257425742574, 0.58, 0.584158415841584, 0.59, 0.594059405940594, 0.6, 0.603960396039604, 0.61, 0.613861386138614, 0.62, 0.623762376237624, 0.63, 0.633663366336634, 0.64, 0.643564356435644, 0.65, 0.653465346534653, 0.66, 0.663366336633663, 0.67, 0.673267326732673, 0.68, 0.683168316831683, 0.69, 0.693069306930693, 0.7, 0.702970297029703, 0.71, 0.712871287128713, 0.72, 0.722772277227723, 0.73, 0.732673267326733, 0.74, 0.742574257425743, 0.75, 0.752475247524752, 0.76, 0.762376237623762, 0.77, 0.772277227722772, 0.78, 0.782178217821782, 0.79, 0.792079207920792, 0.8, 0.801980198019802, 0.81, 0.811881188118812, 0.82, 0.821782178217822, 0.83, 0.831683168316832, 0.84, 0.841584158415842, 0.85, 0.851485148514851, 0.86, 0.861386138613861, 0.87, 0.871287128712871, 0.88, 0.881188118811881, 0.89, 0.891089108910891, 0.9, 0.900990099009901, 0.91, 0.910891089108911, 0.92, 0.920792079207921, 0.93, 0.930693069306931, 0.94, 0.940594059405941, 0.95, 0.95049504950495, 0.96, 0.96039603960396, 0.97, 0.97029702970297, 0.98, 0.98019801980198, 0.99, 0.99009900990099)
Ruu1 <- c(0.0099009900990099, 0.01, 0.0198019801980198, 0.02, 0.0297029702970297, 0.03, 0.0396039603960396, 0.04, 0.0495049504950495, 0.05, 0.0594059405940594, 0.06, 0.0693069306930693, 0.07, 0.0792079207920792, 0.08, 0.0891089108910891, 0.09, 0.099009900990099, 0.1, 0.108910891089109, 0.11, 0.118811881188119, 0.12, 0.128712871287129, 0.13, 0.138613861386139, 0.14, 0.148514851485149, 0.15, 0.158415841584158, 0.16, 0.168316831683168, 0.17, 0.178217821782178, 0.18, 0.188118811881188, 0.19, 0.198019801980198, 0.2, 0.207920792079208, 0.21, 0.217821782178218, 0.22, 0.227722772277228, 0.23, 0.237623762376238, 0.24, 0.247524752475248, 0.25, 0.257425742574257, 0.26, 0.267326732673267, 0.27, 0.277227722772277, 0.28, 0.287128712871287, 0.29, 0.297029702970297, 0.3, 0.306930693069307, 0.31, 0.316831683168317, 0.32, 0.326732673267327, 0.33, 0.336633663366337, 0.34, 0.346534653465347, 0.35, 0.356435643564356, 0.36, 0.366336633663366, 0.37, 0.376237623762376, 0.38, 0.386138613861386, 0.39, 0.396039603960396, 0.4, 0.405940594059406, 0.41, 0.415841584158416, 0.42, 0.425742574257426, 0.43, 0.435643564356436, 0.44, 0.445544554455446, 0.45, 0.455445544554455, 0.46, 0.465346534653465, 0.47, 0.475247524752475, 0.48, 0.485148514851485, 0.49, 0.495049504950495, 0.5, 0.504950495049505, 0.51, 0.514851485148515, 0.52, 0.524752475247525, 0.53, 0.534653465346535, 0.54, 0.544554455445545, 0.55, 0.554455445544555, 0.56, 0.564356435643564, 0.57, 0.574257425742574, 0.58, 0.584158415841584, 0.59, 0.594059405940594, 0.6, 0.603960396039604, 0.61, 0.613861386138614, 0.62, 0.623762376237624, 0.63, 0.633663366336634, 0.64, 0.643564356435644, 0.65, 0.653465346534653, 0.66, 0.663366336633663, 0.67, 0.673267326732673, 0.68, 0.683168316831683, 0.69, 0.693069306930693, 0.7, 0.702970297029703, 0.71, 0.712871287128713, 0.72, 0.722772277227723, 0.73, 0.732673267326733, 0.74, 0.742574257425743, 0.75, 0.752475247524752, 0.76, 0.762376237623762, 0.77, 0.772277227722772, 0.78, 0.782178217821782, 0.79, 0.792079207920792, 0.8, 0.801980198019802, 0.81, 0.811881188118812, 0.82, 0.821782178217822, 0.83, 0.831683168316832, 0.84, 0.841584158415842, 0.85, 0.851485148514851, 0.86, 0.861386138613861, 0.87, 0.871287128712871, 0.88, 0.881188118811881, 0.89, 0.891089108910891, 0.9, 0.900990099009901, 0.91, 0.910891089108911, 0.92, 0.920792079207921, 0.93, 0.930693069306931, 0.94, 0.940594059405941, 0.95, 0.95049504950495, 0.96, 0.96039603960396, 0.97, 0.97029702970297, 0.98, 0.98019801980198, 0.99, 0.99009900990099, 1 )
CPPuu0 <- c(0, 0.00990099, 0.01, 0.019802, 0.02, 0.029703, 0.03, 0.039604, 0.04, 0.049505, 0.05, 0.0594059, 0.06, 0.0693069, 0.07, 0.0792079, 0.08, 0.0891089, 0.09, 0.0990099, 0.1, 0.108911, 0.11, 0.118812, 0.12, 0.128713, 0.13, 0.138614, 0.14, 0.148515, 0.15, 0.158416, 0.16, 0.168317, 0.17, 0.178218, 0.18, 0.188119, 0.19, 0.19802, 0.2, 0.207921, 0.21, 0.217822, 0.22, 0.227723, 0.23, 0.237624, 0.24, 0.247525, 0.25, 0.257426, 0.26, 0.267327, 0.27, 0.277228, 0.28, 0.287129, 0.29, 0.29703, 0.3, 0.306931, 0.31, 0.316832, 0.32, 0.326733, 0.33, 0.336634, 0.34, 0.346535, 0.35, 0.356436, 0.36, 0.366337, 0.37, 0.376238, 0.38, 0.386139, 0.39, 0.39604, 0.4, 0.405941, 0.41, 0.415842, 0.42, 0.425743, 0.43, 0.435644, 0.44, 0.445545, 0.45, 0.455446, 0.46, 0.465347, 0.47, 0.475248, 0.48, 0.485149, 0.49, 0.49505, 0.5, 0.50495, 0.51, 0.514851, 0.52, 0.524752, 0.53, 0.534653, 0.54, 0.544554, 0.55, 0.554455, 0.56, 0.564356, 0.57, 0.574257, 0.58, 0.584158, 0.59, 0.594059, 0.6, 0.60396, 0.61, 0.613861, 0.62, 0.623762, 0.63, 0.633663, 0.64, 0.643564, 0.65, 0.653465, 0.66, 0.663366, 0.67, 0.673267, 0.68, 0.683168, 0.69, 0.693069, 0.7, 0.70297, 0.71, 0.712871, 0.72, 0.722772, 0.73, 0.732673, 0.74, 0.742574, 0.75, 0.752475, 0.76, 0.762376, 0.77, 0.772277, 0.78, 0.782178, 0.79, 0.792079, 0.8, 0.80198, 0.81, 0.811881, 0.82, 0.821782, 0.83, 0.831683, 0.84, 0.841584, 0.85, 0.851485, 0.86, 0.861386, 0.87, 0.871287, 0.88, 0.881188, 0.89, 0.891089, 0.9, 0.90099, 0.91, 0.910891, 0.92, 0.920792, 0.93, 0.930693, 0.94, 0.940594, 0.95, 0.950495, 0.96, 0.960396, 0.97, 0.970297, 0.98, 0.980198, 0.99, 0.990099)
CPPuu1 <- c(0.00990099, 0.01, 0.019802, 0.02, 0.029703, 0.03, 0.039604, 0.04, 0.049505, 0.05, 0.0594059, 0.06, 0.0693069, 0.07, 0.0792079, 0.08, 0.0891089, 0.09, 0.0990099, 0.1, 0.108911, 0.11, 0.118812, 0.12, 0.128713, 0.13, 0.138614, 0.14, 0.148515, 0.15, 0.158416, 0.16, 0.168317, 0.17, 0.178218, 0.18, 0.188119, 0.19, 0.19802, 0.2, 0.207921, 0.21, 0.217822, 0.22, 0.227723, 0.23, 0.237624, 0.24, 0.247525, 0.25, 0.257426, 0.26, 0.267327, 0.27, 0.277228, 0.28, 0.287129, 0.29, 0.29703, 0.3, 0.306931, 0.31, 0.316832, 0.32, 0.326733, 0.33, 0.336634, 0.34, 0.346535, 0.35, 0.356436, 0.36, 0.366337, 0.37, 0.376238, 0.38, 0.386139, 0.39, 0.39604, 0.4, 0.405941, 0.41, 0.415842, 0.42, 0.425743, 0.43, 0.435644, 0.44, 0.445545, 0.45, 0.455446, 0.46, 0.465347, 0.47, 0.475248, 0.48, 0.485149, 0.49, 0.49505, 0.5, 0.50495, 0.51, 0.514851, 0.52, 0.524752, 0.53, 0.534653, 0.54, 0.544554, 0.55, 0.554455, 0.56, 0.564356, 0.57, 0.574257, 0.58, 0.584158, 0.59, 0.594059, 0.6, 0.60396, 0.61, 0.613861, 0.62, 0.623762, 0.63, 0.633663, 0.64, 0.643564, 0.65, 0.653465, 0.66, 0.663366, 0.67, 0.673267, 0.68, 0.683168, 0.69, 0.693069, 0.7, 0.70297, 0.71, 0.712871, 0.72, 0.722772, 0.73, 0.732673, 0.74, 0.742574, 0.75, 0.752475, 0.76, 0.762376, 0.77, 0.772277, 0.78, 0.782178, 0.79, 0.792079, 0.8, 0.80198, 0.81, 0.811881, 0.82, 0.821782, 0.83, 0.831683, 0.84, 0.841584, 0.85, 0.851485, 0.86, 0.861386, 0.87, 0.871287, 0.88, 0.881188, 0.89, 0.891089, 0.9, 0.90099, 0.91, 0.910891, 0.92, 0.920792, 0.93, 0.930693, 0.94, 0.940594, 0.95, 0.950495, 0.96, 0.960396, 0.97, 0.970297, 0.98, 0.980198, 0.99, 0.990099, 1,)
CPPuu1 <- c(0.00990099, 0.01, 0.019802, 0.02, 0.029703, 0.03, 0.039604, 0.04, 0.049505, 0.05, 0.0594059, 0.06, 0.0693069, 0.07, 0.0792079, 0.08, 0.0891089, 0.09, 0.0990099, 0.1, 0.108911, 0.11, 0.118812, 0.12, 0.128713, 0.13, 0.138614, 0.14, 0.148515, 0.15, 0.158416, 0.16, 0.168317, 0.17, 0.178218, 0.18, 0.188119, 0.19, 0.19802, 0.2, 0.207921, 0.21, 0.217822, 0.22, 0.227723, 0.23, 0.237624, 0.24, 0.247525, 0.25, 0.257426, 0.26, 0.267327, 0.27, 0.277228, 0.28, 0.287129, 0.29, 0.29703, 0.3, 0.306931, 0.31, 0.316832, 0.32, 0.326733, 0.33, 0.336634, 0.34, 0.346535, 0.35, 0.356436, 0.36, 0.366337, 0.37, 0.376238, 0.38, 0.386139, 0.39, 0.39604, 0.4, 0.405941, 0.41, 0.415842, 0.42, 0.425743, 0.43, 0.435644, 0.44, 0.445545, 0.45, 0.455446, 0.46, 0.465347, 0.47, 0.475248, 0.48, 0.485149, 0.49, 0.49505, 0.5, 0.50495, 0.51, 0.514851, 0.52, 0.524752, 0.53, 0.534653, 0.54, 0.544554, 0.55, 0.554455, 0.56, 0.564356, 0.57, 0.574257, 0.58, 0.584158, 0.59, 0.594059, 0.6, 0.60396, 0.61, 0.613861, 0.62, 0.623762, 0.63, 0.633663, 0.64, 0.643564, 0.65, 0.653465, 0.66, 0.663366, 0.67, 0.673267, 0.68, 0.683168, 0.69, 0.693069, 0.7, 0.70297, 0.71, 0.712871, 0.72, 0.722772, 0.73, 0.732673, 0.74, 0.742574, 0.75, 0.752475, 0.76, 0.762376, 0.77, 0.772277, 0.78, 0.782178, 0.79, 0.792079, 0.8, 0.80198, 0.81, 0.811881, 0.82, 0.821782, 0.83, 0.831683, 0.84, 0.841584, 0.85, 0.851485, 0.86, 0.861386, 0.87, 0.871287, 0.88, 0.881188, 0.89, 0.891089, 0.9, 0.90099, 0.91, 0.910891, 0.92, 0.920792, 0.93, 0.930693, 0.94, 0.940594, 0.95, 0.950495, 0.96, 0.960396, 0.97, 0.970297, 0.98, 0.980198, 0.99, 0.990099, 1)
CPPuu1 == Ruu1
round(CPPuu1,6) == roud(Ruu1,6)
round(CPPuu1,6) == round(Ruu1,6)
source('~/Desktop/scrna-diffexpr/test/debug_run.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/relative_errors.r')
plot(1:1000, error.rel.eqlenvecs, main="wasserstein_metric vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Equal length input vectors", pch=20)
plot(1:1000, error.rel.uneqlenvecs, main="wasserstein_metric vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Different length input vectors", pch=20)
source('~/Desktop/scrna-diffexpr/relative_comparisons/relative_errors.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/relative_errors.r')
install_github("easyGgplot2", "kassambara")
library("devtools")
install_github("easyGgplot2", "kassambara")
install.packages("easyGgplot2", "kassambara")
install.packages("kassambara/easyGgplot2")
install.packages("ggplot2")
ggplot2.scatterplot
source('~/Desktop/scrna-diffexpr/relative_comparisons/relative_errors.r')
plot(1:1000, error.rel.uneqlenvecs.approx, main="wasserstein_approx vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Different length input vectors", pch=20)
plot(1:1000, error.rel.eqlenvecs.approx, main="wasserstein_approx vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Equal length input vectors", pch=20)
source('~/Desktop/scrna-diffexpr/relative_comparisons/relative_errors.r')
plot(1:1000, error.rel.uneqlenvecs.approx, main="wasserstein_approx vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Different length input vectors", pch=20)
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
x <- rnorm(10,20,2)
y <- c(rnorm(4, 18,2), rnorm(6, 23,2))
sqrt(squared_wass_decomp(x,y,2)["distance"]
)
squared_wass_decomp(x,y,2)["distance"]
unlist(squared_wass_decomp(x,y,2)["distance"])
class( unlist(squared_wass_decomp(x,y,2)["distance"]))
typeof( unlist(squared_wass_decomp(x,y,2)["distance"]))
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
mean(error.rel.eqlenvecs.approx)
mean(error.rel.uneqlenvecs.approx)
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
mean(error.rel.uneqlenvecs.approx)
mean(error.rel.eqlenvecs.approx)
print(benchmark(wasserstein1d(x,z,p=2), wasserstein_metric(x,z,2), squared_wass_approx(x,z,2), squared_wass_decomp(x,z,2)))
print(rbenchmark(wasserstein1d(x,z,p=2), wasserstein_metric(x,z,2), squared_wass_approx(x,z,2), squared_wass_decomp(x,z,2)))
print(benchmark(wasserstein1d(x,y,p=2), wasserstein_metric(x,y,2), squared_wass_approx(x,y,2), squared_wass_decomp(x,y,2)))
library(rbenchmark)
library("rbenchmark")
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/benchmark.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/benchmark.r')
df <- cbind(error.rel.eqlenvecs, error.rel.uneqlenvecs, error.rel.eqlenvecs.approx, error.rel.uneqlenvecs.approx, error.rel.eqlenvecs.decomp, error.rel.uneqlenvecs.decomp)
df
error.rel.df <- data.frame(df)
error.rel.df
describe(error.rel.df)
mean(error.rel.df)
colMeans(error.rel.df)
apply(error.rel.df, 2, _UI <- function(id) {
ns <- NS(id)
tagList(
)
}
<- function(input, output, session) {
})
sd
?sd
apply(error.rel.df, 2, sd)
plot(1:1000, error.rel.uneqlenvecs.approx, main="squared_wass_approx vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Different length input vectors", pch=20)
plot(1:1000, error.rel.eqlenvecs.approx, main="squared_wass_approx vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Equal length input vectors", pch=20)
plot(1:1000, error.rel.eqlenvecs.decomp, main="squared_wass_decomp vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Equal length input vectors", pch=20)
plot(1:1000, error.rel.uneqlenvecs.decomp, main="squared_wass_decomp vs wasserstein1d", ylab="relative error in %", xlab="input length", sub="Different length input vectors", pch=20)
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
?quantile
?cor
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
a <- tuple("sc19", 1)
a <- as.tuple("sc19", 1)
a <- as.tuple(c("sc19", 1))
b = "foo"
x <- c("baaar")
a <-cbind (b,x)
a
deparse(quote(b))
unquote(b)
deparse(b)
b
a <- c(1,2,3,4,5,6,7,8)
combn(a, 2)
INPUT_DATA = "/home/julian/Desktop/scrna-diffexpr/case_study/data/DataMatrices_ScSubsets.dat"
load(INPUT_DATA)
a <- c(sc.f19.blood, sc.f19.decidua, sc.f20.blood, sc.f20.decidua)
a
load(INPUT_DATA)
a = 2
as.name("a")
eval(as.name("a"))
INPUT_DATA = "/home/julian/Desktop/scrna-diffexpr/case_study/data/DataMatrices_ScSubsets.dat"
load(INPUT_DATA)
TABLE_NAMES = c("sc.f19.blood", "sc.f19.decidua", "sc.f20.blood",  "sc.f20.decidua", "sc.f25.blood", "sc.f25.decidua", "sc.f27.blood", "sc.f27.decidua")
combn(TA)
combn(TABLE_NAMES, 2)
?combn
?sub
sub(".", "", "hall.o")
sub("\.", "", "hall.o")
sub(""\.", "", "hall.o")
sub("*.", "", "hall.o")
sub("", "", "hall.o")
sub("", "", "hall.o")
sub("ha", "", "hall.o")
sub(".", "", "hall.o")
sub("[.]", "", "hall.o")
source('~/Desktop/scrna-diffexpr/case_study/case_study.R')
source('~/Desktop/scrna-diffexpr/case_study/case_study.R')
source('~/Desktop/scrna-diffexpr/case_study/scripts/case_study.R')
library("waddR")
version()
sessionInfo()
unloadNamespace("waddR")
library("waddR")
sessionInfo()
a <- c(2,3,1)
b <- c(3,3,2,6)
results <- sapply(1:100, function(I) { wasserstein_metric(x,y,p=2)})
results <- sapply(1:100, function(I) { wasserstein_metric(a,b,p=2)})
results
?blapply
library("Biocparallel")
library("BiocParallel")
BiocManager::install("BiocFileCache")
tempfile()
tempfile()
rappdirs::app_dir()
rappdirs::user_cache_dir()
path <- tempfile()
?BioFileCache
library("BioFileCache")
library("biofilecache")
library("biocfilecache")
library("BiocFileCache")
?BiocFileCache
bfc <- BiocFileCache(path, as = FALSE)
bfc
library("waddR")
empcdf.ref
add1 <- bfcadd(bfc, "REF_DIST", waddR:::empcdf.ref)
add1 <- bfcadd(bfc, "REF_DIST", system.file("data/empcdf_ref.RDat", package="waddR"))
system.file("data/empcdf_ref.RDat", package="waddR")
system.file("data/empcdf_ref.RData", package="waddR")
add1 <- bfcadd(bfc, "REF_DIST", system.file("data/empcdf_ref.RData", package="waddR"))
bcf
bfc
bfcinfo(bfc)
bfc$REF_DIST
bfc[["REF_DIST"]]
bfc[["BFC1"]]
url <- "https://github.com/goncalves-lab/waddR/blob/rcmdcheck_success/data/empcdf_ref.RData"
?BiocFileCache
bfc <- BiocFilecache(ask=FAlSE)
bfc <- BiocFileCache(ask=FAlSE)
bfc <- BiocFileCache(ask=FALSE)
bfc
path <- bfcrpath(bfc, url)
path
library("waddR")
brownianbridge.empcdf.url
path <- waddR:::cache.getOrDownload(brownianbridge.empcdf.url, "empcdf.ref")
path
quantile(1:10, (seq(1:5)-0.5) / 5)
quantile(1:10, (seq(1:5)-0.5) / 5, type=)
quantile(1:10, (seq(1:5)-0.5) / 5, type=1)
quantile(1:10, (seq(1:10)-0.5) / 10, type=1)
quantile(1:10, (seq(1:20)-0.5) / 20, type=1)
quantile(1:10, (seq(1:15)-0.5) / 15, type=1)
(seq(1:15)-0.5) / 15
2 + TRUE
2 + FALSE
?sort
sort(c(1,2,3), partial=c(1,23))
sort(c(1,2,3), partial=1)
sort(c(1,2,3), partial=103)
sort(c(1,2,3), partial=2)
sort(c(1,2,3), partial=3)
sort(c(1,2,3), partial=0)
sort(c(1,2,3), partial=)
sort(c(1,2,3,123,2,3,4,1,343,3), partial=1)
sort(c(1,2,3,123,2,3,4,1,343,3), partial=2)
sort(c(1,2,3,123,2,3,4,1,343,3), partial=3)
sort(c(1,2,3,123,2,3,4,1,343,3), partial=4)
sort(c(1,2,3,123,2,3,4,1,343,3), partial=6)
sort(c(1,2,3,123,2,3,4,1,343,3), partial=(1,2,3))
sort(c(1,2,3,123,2,3,4,1,343,3), partial=c(1,2,3))
sort(c(1,2,3,123,2,3,4,1,343,3), partial=c(1,5,10))
x <- c(13,14,25,26,26,27,40,44,52,93)
x <- c(x[1],x[1], x, x[10], x[10])
x
probs = (seq(1:5) -0.5) / 5
probs
probs = (seq(1:4)) / 4
probs
nppm = probs * 10
nppm
j <- floor(nppm)
j
h <- npmm > j
h <- nppm > j
h
x
qs <- x[j+2]
qs
qs[h==0]
qs[h==0] <- x[j+3][h==1]
qs
qx[j+3][h==1]
x[j+3][h==1]
x[j+3]
j
h==
1
0 < h
0 < h & 1 < h
quantile(c(1:10), seq(1:10)/10)
unlist(quantile(c(1:10), seq(1:10)/10))
values(quantile(c(1:10), seq(1:10)/10))
quantile(c(1:10), seq(1:10)/10, type=1) ==
c(1   , 2  ,  3  ,  4    ,5   , 6 ,   7  ,  8  ,  9  , 10 )
suppressPackageStartupMessages({
library(ExperimentHub)
library(SingleCellExperiment)
})
BiocManager::install("HCAData")
library("ExperimentHub")
eh <- ExperimentHub()
eh
query(eh, "homo sapiens")
query(eh, "SingleCellExperiment")
scexperiments <- query(eh, "SingleCellExperiment")
humansc_experiments <- query(scexperiments, "human")
humansc_experiments
humansc_experiments <- query(scexperiments, "homo sapiens")
humansc_experiments
query(humansc_experiments, "decidua")
query(humansc_experiments, "blood")
query(humansc_experiments, "blone marow")
query(eh, "HCAData")
query(humansc_experiments, "HCAData")
bonemarrow_h5densematrix <- eh[["EH2047"]]
bonemarrow_coldata <- eh[["EH2048"]]
bonemarrow_rowdata <- eh[["EH2049"]]
library("HCAData")
# and are put together when calling...
sce_bonemarrow <- HCAData("ica_bone_marrow")
sce_bonemarrow
sce_cordblood <- HCAData("ica_cord_blood")
sce_cordblood
colnames(sce_bonemarrow)
install.packages("scran", "scater")
setRepositories()
install.packages("scran", "scater")
library("scater")
uniquifyFeatureNames(rowData(sce_bonemarrow)$ID, rowdata(sce_bonemarrow)$Symbol)
uniquifyFeatureNames(rowData(sce_bonemarrow)$ID, rowData(sce_bonemarrow)$Symbol)
clusters <- quickCluster(sce, method="igraph", min.mean=0.1, irlba.args=list(maxit=1000))
library("scater")
clusters <- quickCluster(sce, method="igraph", min.mean=0.1, irlba.args=list(maxit=1000))
library("scran")
clusters <- quickCluster(sce, method="igraph", min.mean=0.1, irlba.args=list(maxit=1000))
bonemarrow_clusters <- quickCluster(sce_bonemarrow, method="igraph", min.mean=0.1, irlba.args=list(maxit=1000))
sce_bm <- sce_bonemarrow[, sample(colnames(sce_bonemarrow),
100, replace=FALSE)]
bm.clusters <- quickCluster(sce_bm, method="igraph", min.mean=0.1, irlba.args=list(maxit=1000))
sce_bm <- computeSumFactors(sce_bm, clusters=bm.clusters)
?quickCluster
summarize(sizeFactors(sce_bm))
sumarize(sizeFactors(sce_bm))
summary(sizeFactors(sce_bm))
rowmin(sce_bm)
rowmins(sce_bm)
rowMins(sce_bm)
sce_bm
rowData(sce_bm)
colData(sce_bm)
Data(sce_bm)
data(sce_bm)
sce_bm
sce_bm["MantonBM3_HiSeq_6-TTTACTGGTTCAGACT-1",]
sce_bm[,"MantonBM3_HiSeq_6-TTTACTGGTTCAGACT-1"]
?computeSumFactors
bm.clusters
table(bm.clusters)
sce_bm
sce_bm <- sce_bonemarrow[, sample(colnames(sce_bonemarrow),
100, replace=FALSE)]
sce_bm <- computeSumFactors(sce_bm)
sce_bm
sce_ucb <- sce_umbcordblood[, sample(colnames(sce_umbcordblood),
100, replace=FALSE)]
sce_umbcordblood <- HCAData("ica_cord_blood")
sce_ucb <- sce_umbcordblood[, sample(colnames(sce_umbcordblood),
100, replace=FALSE)]
tic(); sce_ucb <- computeSumFactors(sce_ucb); toc()
library("tictoc")
tic(); sce_ucb <- computeSumFactors(sce_ucb); toc()
ls(sce)
ls(sce_bm)
sce_ucb
rownames(sce_ucb )
all(rownames(sce_ucb ) == rownames(sce_bm))
dat <- rbin(sce_ucb, sce_bm)
dat <- rbind(sce_ucb, sce_bm)
dat <- cbind(sce_ucb, sce_bm)
dat
dat[1,]
dat[1,1]
dat[1,2]
dat[1,3]
?SingleCellExperiment
rowData(sce_bm)
rowData(sce_bm[1,])
rowData(sce_bm["MantonCB1_HiSeq_3-CCTTCGAAGTGTACTC-1"])
sce_bm["MantonCB1_HiSeq_3-CCTTCGAAGTGTACTC-1"]
sce_bm[,"MantonCB1_HiSeq_3-CCTTCGAAGTGTACTC-1"]
sce_bm["MantonCB1_HiSeq_3-CCTTCGAAGTGTACTC-1",]
wasserstein.sc(dat, c(rep(1,100), rep(2,100)))
library("waddR")
wasserstein.sc(dat, c(rep(1,100), rep(2,100)))
wasserstein.sc(dat, c(rep(1,100), rep(2,100)), method="OS")
dat
dat[1,]
dat[1,2]
reduceDims(sce_bm)
reduceDim(sce_bm)
reducedDim(sce_bm)
sce_bm
assay(sce_bm, counts)
counts <- assay(sce_bm, "counts")
counts
dat <- c(assay(sce_bm, "counts"), assay(sce_ucb, "counts"))
dat <- cbind(assay(sce_bm, "counts"), assay(sce_ucb, "counts"))
dat
conditions <- rep(1,100), rep(2,100)
conditions <- c(rep(1,100), rep(2,100))
res <- wasserstein.sc(dat, conditions, methods="TS")
res <- wasserstein.sc(dat, conditions, method="TS")
res <- wasserstein.sc(dat, conditions, permnum=10000, method="TS")
res <- wasserstein.sc(dat, conditions, permnum=10000, method="TS")
res <- wasserstein.sc(dat, conditions, permnum=10000, method="OS")
detach("package:waddR", unload = TRUE)
library(waddR)
dat
dim(dat)
res <- wasserstein.sc(dat, conditions, permnum=10000, method="OS")
tic(); res <- wasserstein.sc(dat, conditions, permnum=10000, method="OS"); toc()
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/relative_errors.r')
source('~/Desktop/scrna-diffexpr/relative_comparisons/Scripts/benchmark.r')
Sys.getpid()
lsfit(c(1,2,3), c(2,4,6))
setwd("/home/julian/Desktop/single_cell_type_of_origin/")
cd("data/")
setwd("data/")
ls
dir()
load("DataKinam.dat")
colnames("DataKinam.dat")
colnames(AnnotatedGenes_final)
AnnotatedGenes_final["M-BM5__Plasma Cell" ]
colnames(AnnotatedGenes_final)
cell.types <- colnames(AnnotatedGenes_final)[1:280]
cell.types
colMeans(AnnotatedGenes_final[,cell.types])
?colMean
?colMeans
cell.types <- colnames(AnnotatedGenes_final)[2:280]
colMeans(AnnotatedGenes_final[,cell.types])
write.csv(x = AnnotatedGenes_final[,c("gene.names",cell.types)], file="mutation_frequencies.csv")
AnnotatedGenes_final[,c("gene.names",cell.types)]
colnames(AnnotatedGenes_final)
write.csv(x = AnnotatedGenes_final[,c("gene_name",cell.types)], file="mutation_frequencies.csv")
df =  AnnotatedGenes_final[,c(,cell.types)]
df =  AnnotatedGenes_final[,c(cell.types)]
df
rownames(df) <- AnnotatedGenes_final[,"gene_name"]
AnnotatedGenes_final[,"gene_name"]
gene_names
cell.types
View(AnnotatedGenes_final)
colSums(AnnotatedGenes_final[,c(cell.types)])
apply(AnnotatedGenes_final[,c(cell.types), 1, sum])
apply(AnnotatedGenes_final[,c(cell.types)], 1, sum)
apply(AnnotatedGenes_final[,c(cell.types)], 2, sum)
apply(AnnotatedGenes_final[,c(cell.types)], 2, max)
